2025-12-15 23:22:09 MST
----------------------------------------------------------------------------
device: cuda
{'experiment_id': None, 'dataset': 'mnist', 'tau': 15.0, 'seed': 0, 'batch_size': 128, 'learning_rate': 0.01, 'training_bit_count': 32, 'implementation': 'cuda', 'num_iterations': 15000, 'eval_freq': 1000, 'valid_set_size': 0.0, 'extensive_eval': False, 'connections': 'unique', 'architecture': 'threshold_connected', 'num_neurons': 2000, 'num_layers': 1, 'num_active': 6, 'number_kernels': 16, 'grad_factor': 1.0}
total_num_neurons=3000
total_num_weights=4597081
CustomModel(
  (model): Sequential(
    (0): Conv(
      (gatebank): WeightedThresholdGate()
    )
    (1): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (2): Conv(
      (gatebank): WeightedThresholdGate()
    )
    (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (4): Conv(
      (gatebank): WeightedThresholdGate()
    )
    (5): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (6): Flatten(start_dim=1, end_dim=-1)
    (7): ThresholdLayer(in_dim=1296, out_dim=2000, num_active_connections=6, bias=True)
    (8): CustomSigmoid(scale=1.0)
    (9): ThresholdLayer(in_dim=2000, out_dim=1000, num_active_connections=6, bias=True)
    (10): CustomSigmoid2(scale=1.0)
    (11): GroupSum(k=10, tau=15.0)
  )
)
Iteration 1000/15000: Loss = 0.779331
Batches per epoch:         79
{'train_acc_eval_mode': 0.945245868869936, 'test_acc_eval_mode': 0.9455102848101266, 'test_acc_train_mode': 0.9672666139240507}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 94.55%
Iteration 2000/15000: Loss = 0.105282
Batches per epoch:         79
{'train_acc_eval_mode': 0.9534137349393068, 'test_acc_eval_mode': 0.953125, 'test_acc_train_mode': 0.971123417721519}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 95.31%
Iteration 3000/15000: Loss = 0.087144
Batches per epoch:         79
{'train_acc_eval_mode': 0.9600935057282194, 'test_acc_eval_mode': 0.9614319620253164, 'test_acc_train_mode': 0.9779469936708861}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 96.14%
Iteration 4000/15000: Loss = 0.081928
Batches per epoch:         79
{'train_acc_eval_mode': 0.9554959577538057, 'test_acc_eval_mode': 0.9589596518987342, 'test_acc_train_mode': 0.9777492088607594}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 5000/15000: Loss = 0.078090
Batches per epoch:         79
{'train_acc_eval_mode': 0.9611373933901919, 'test_acc_eval_mode': 0.9605419303797469, 'test_acc_train_mode': 0.9768591772151899}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 6000/15000: Loss = 0.077512
Batches per epoch:         79
{'train_acc_eval_mode': 0.9621590707602024, 'test_acc_eval_mode': 0.9642009493670886, 'test_acc_train_mode': 0.9786392405063291}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 96.42%
Iteration 7000/15000: Loss = 0.078001
Batches per epoch:         79
{'train_acc_eval_mode': 0.9614316809660336, 'test_acc_eval_mode': 0.9632120253164557, 'test_acc_train_mode': 0.9785403481012658}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 8000/15000: Loss = 0.078498
Batches per epoch:         79
{'train_acc_eval_mode': 0.9605099502911192, 'test_acc_eval_mode': 0.9607397151898734, 'test_acc_train_mode': 0.9783425632911392}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 9000/15000: Loss = 0.079860
Batches per epoch:         79
{'train_acc_eval_mode': 0.9596659560193385, 'test_acc_eval_mode': 0.9597507911392406, 'test_acc_train_mode': 0.9775514240506329}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 10000/15000: Loss = 0.081061
Batches per epoch:         79
{'train_acc_eval_mode': 0.9621646233967373, 'test_acc_eval_mode': 0.9622231012658228, 'test_acc_train_mode': 0.9773536392405063}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Iteration 11000/15000: Loss = 0.083902
Batches per epoch:         79
{'train_acc_eval_mode': 0.9617148632688055, 'test_acc_eval_mode': 0.966376582278481, 'test_acc_train_mode': 0.9761669303797469}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 96.64%
Iteration 12000/15000: Loss = 0.085507
Batches per epoch:         79
{'train_acc_eval_mode': 0.9631863006396588, 'test_acc_eval_mode': 0.9641020569620253, 'test_acc_train_mode': 0.9769580696202531}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
Iteration 13000/15000: Loss = 0.070631
Batches per epoch:         79
{'train_acc_eval_mode': 0.9649853411513859, 'test_acc_eval_mode': 0.9665743670886076, 'test_acc_train_mode': 0.9803204113924051}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
Best Accuracy: 96.66%
Iteration 14000/15000: Loss = 0.063850
Batches per epoch:         79
{'train_acc_eval_mode': 0.9661958067656071, 'test_acc_eval_mode': 0.9674643987341772, 'test_acc_train_mode': 0.9805181962025317}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
Best Accuracy: 96.75%
Iteration 15000/15000: Loss = 0.061479
Batches per epoch:         79
{'train_acc_eval_mode': 0.9651630242496158, 'test_acc_eval_mode': 0.9648931962025317, 'test_acc_train_mode': 0.9801226265822784}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
[minimize_truth_tables] Wrote 884 unique non-constant functions to out/minimized_expressions_mnist.txt


Processed 10000 samples out of 10000 available test samples.
Test Accuracy: 96.45%
