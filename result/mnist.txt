----------------------------------------------------------------------------
2025-12-14 07:48:26.539337
device: cuda
torch: 2.7.1+cu118 | cuda available: True | built-with CUDA: 11.8
GPU: NVIDIA A40
{'experiment_id': None, 'dataset': 'mnist', 'tau': 17.0, 'seed': 0, 'batch_size': 128, 'learning_rate': 0.01, 'training_bit_count': 32, 'implementation': 'cuda', 'num_iterations': 20000, 'eval_freq': 1000, 'valid_set_size': 0.0, 'extensive_eval': False, 'connections': 'unique', 'architecture': 'threshold_connected', 'num_neurons': 2000, 'num_layers': 1, 'num_active': 6, 'grad_factor': 2.0}
total_num_neurons=3000
total_num_weights=6707001
model is on: cuda:0
CustomModel(
  (model): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): ThresholdLayer(in_dim=2352, out_dim=2000, num_active_connections=6, bias=True)
    (2): CustomSigmoid(scale=1.0)
    (3): ThresholdLayer(in_dim=2000, out_dim=1000, num_active_connections=6, bias=True)
    (4): CustomSigmoid2(scale=1.0)
    (5): GroupSum(k=10, tau=17.0)
  )
)


Iteration 1000/20000: Loss = 0.559456
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9303218482905983, 'test_acc_eval_mode': 0.9294871794871795}
Current Learning Rate: 1.00e-02
Best Accuracy: 92.95%
Iteration 2000/20000: Loss = 0.256298
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9369991987179487, 'test_acc_eval_mode': 0.9344951923076923}
Current Learning Rate: 1.00e-02
Best Accuracy: 93.45%
Iteration 3000/20000: Loss = 0.234512
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9417234241452992, 'test_acc_eval_mode': 0.9409054487179487}
Current Learning Rate: 1.00e-02
Best Accuracy: 94.09%
Iteration 4000/20000: Loss = 0.223970
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9397702991452992, 'test_acc_eval_mode': 0.9380008012820513}
Current Learning Rate: 1.00e-02
Iteration 5000/20000: Loss = 0.220255
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9415064102564102, 'test_acc_eval_mode': 0.9393028846153846}
Current Learning Rate: 1.00e-02
Iteration 6000/20000: Loss = 0.217008
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9405381944444444, 'test_acc_eval_mode': 0.9373998397435898}
Current Learning Rate: 1.00e-02
Iteration 7000/20000: Loss = 0.216478
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402043269230769, 'test_acc_eval_mode': 0.9368990384615384}
Current Learning Rate: 1.00e-03
Iteration 8000/20000: Loss = 0.205781
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9410223023504274, 'test_acc_eval_mode': 0.9398036858974359}
Current Learning Rate: 1.00e-03
Iteration 9000/20000: Loss = 0.200409
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9414897168803419, 'test_acc_eval_mode': 0.9398036858974359}
Current Learning Rate: 1.00e-03
Iteration 10000/20000: Loss = 0.200567
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9408052884615384, 'test_acc_eval_mode': 0.9393028846153846}
Current Learning Rate: 1.00e-03
Iteration 11000/20000: Loss = 0.197376
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.940254407051282, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-03
Iteration 12000/20000: Loss = 0.197331
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9391025641025641, 'test_acc_eval_mode': 0.9378004807692307}
Current Learning Rate: 1.00e-03
Iteration 13000/20000: Loss = 0.196977
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9401041666666666, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-04
Iteration 14000/20000: Loss = 0.195226
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9401041666666666, 'test_acc_eval_mode': 0.9378004807692307}
Current Learning Rate: 1.00e-04
Iteration 15000/20000: Loss = 0.194702
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9401542467948718, 'test_acc_eval_mode': 0.9376001602564102}
Current Learning Rate: 1.00e-04
Iteration 16000/20000: Loss = 0.194050
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9401041666666666, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-04
Iteration 17000/20000: Loss = 0.192938
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402377136752137, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-04
Iteration 18000/20000: Loss = 0.194432
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9398537660256411, 'test_acc_eval_mode': 0.9371995192307693}
Current Learning Rate: 1.00e-04
Iteration 19000/20000: Loss = 0.193729
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9398203792735043, 'test_acc_eval_mode': 0.9365985576923077}
Current Learning Rate: 1.00e-05
Iteration 20000/20000: Loss = 0.192453
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9395866720085471, 'test_acc_eval_mode': 0.936698717948718}
Current Learning Rate: 1.00e-05
[minimize_truth_tables] Wrote 588 unique non-constant functions to out/minimized_expressions_mnist.txt


Test Accuracy: 93.67%
