----------------------------------------------------------------------------
2025-12-13 20:53:27.179825
device: cuda
torch: 2.7.1+cu118 | cuda available: True | built-with CUDA: 11.8
GPU: NVIDIA TITAN Xp
{'experiment_id': None, 'dataset': 'mnist', 'tau': 17.0, 'seed': 0, 'batch_size': 128, 'learning_rate': 0.01, 'training_bit_count': 32, 'implementation': 'cuda', 'num_iterations': 20000, 'eval_freq': 1000, 'valid_set_size': 0.0, 'extensive_eval': False, 'connections': 'unique', 'architecture': 'threshold_connected', 'num_neurons': 2000, 'num_layers': 1, 'num_active': 6, 'grad_factor': 2.0}
total_num_neurons=3000
total_num_weights=6707001
model is on: cuda:0
CustomModel(
  (model): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): ThresholdLayer(in_dim=2352, out_dim=2000, num_active_connections=6, bias=True)
    (2): CustomSigmoid(scale=1.0)
    (3): ThresholdLayer(in_dim=2000, out_dim=1000, num_active_connections=6, bias=True)
    (4): CustomSigmoid2(scale=1.0)
    (5): GroupSum(k=10, tau=17.0)
  )
)


Iteration 1000/20000: Loss = 0.559456
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9303218482905983, 'test_acc_eval_mode': 0.9294871794871795}
Current Learning Rate: 1.00e-02
Best Accuracy: 92.95%
Iteration 2000/20000: Loss = 0.256297
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9367321047008547, 'test_acc_eval_mode': 0.9345953525641025}
Current Learning Rate: 1.00e-02
Best Accuracy: 93.46%
Iteration 3000/20000: Loss = 0.234516
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9413728632478633, 'test_acc_eval_mode': 0.9395032051282052}
Current Learning Rate: 1.00e-02
Best Accuracy: 93.95%
Iteration 4000/20000: Loss = 0.223941
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402210202991453, 'test_acc_eval_mode': 0.9362980769230769}
Current Learning Rate: 1.00e-02
Iteration 5000/20000: Loss = 0.220245
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9411725427350427, 'test_acc_eval_mode': 0.9389022435897436}
Current Learning Rate: 1.00e-02
Iteration 6000/20000: Loss = 0.217119
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9411558493589743, 'test_acc_eval_mode': 0.9381009615384616}
Current Learning Rate: 1.00e-02
Iteration 7000/20000: Loss = 0.216527
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.941940438034188, 'test_acc_eval_mode': 0.9396033653846154}
Current Learning Rate: 1.00e-03
Best Accuracy: 93.96%
Iteration 8000/20000: Loss = 0.206354
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9410890758547008, 'test_acc_eval_mode': 0.938301282051282}
Current Learning Rate: 1.00e-03
Iteration 9000/20000: Loss = 0.200974
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9413895566239316, 'test_acc_eval_mode': 0.9392027243589743}
Current Learning Rate: 1.00e-03
Iteration 10000/20000: Loss = 0.201210
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9412059294871795, 'test_acc_eval_mode': 0.9386017628205128}
Current Learning Rate: 1.00e-03
Iteration 11000/20000: Loss = 0.197829
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9403378739316239, 'test_acc_eval_mode': 0.9377003205128205}
Current Learning Rate: 1.00e-03
Iteration 12000/20000: Loss = 0.197853
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9401208600427351, 'test_acc_eval_mode': 0.9373998397435898}
Current Learning Rate: 1.00e-03
Iteration 13000/20000: Loss = 0.197738
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9399205395299145, 'test_acc_eval_mode': 0.938301282051282}
Current Learning Rate: 1.00e-04
Iteration 14000/20000: Loss = 0.195877
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9405882745726496, 'test_acc_eval_mode': 0.938301282051282}
Current Learning Rate: 1.00e-04
Iteration 15000/20000: Loss = 0.195366
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9403712606837606, 'test_acc_eval_mode': 0.9378004807692307}
Current Learning Rate: 1.00e-04
Iteration 16000/20000: Loss = 0.194719
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402711004273504, 'test_acc_eval_mode': 0.9379006410256411}
Current Learning Rate: 1.00e-04
Iteration 17000/20000: Loss = 0.193600
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402210202991453, 'test_acc_eval_mode': 0.9373998397435898}
Current Learning Rate: 1.00e-04
Iteration 18000/20000: Loss = 0.195109
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9402043269230769, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-04
Iteration 19000/20000: Loss = 0.194409
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9400373931623932, 'test_acc_eval_mode': 0.9375}
Current Learning Rate: 1.00e-05
Iteration 20000/20000: Loss = 0.193110
-----------------------------------------------------------------------------------------------------------------------------------------------------------
{'train_acc_eval_mode': 0.9399706196581197, 'test_acc_eval_mode': 0.9376001602564102}
Current Learning Rate: 1.00e-05
[minimize_truth_tables] Wrote 586 unique non-constant functions to out/minimized_expressions_mnist.txt


Test Accuracy: 93.76%
