----------------------------------------------------------------------------
2025-11-21 09:49:20.964819
device: cuda
torch: 2.7.1+cu118 | cuda available: True | built-with CUDA: 11.8
GPU: NVIDIA TITAN Xp
{'experiment_id': None, 'dataset': 'mnist', 'tau': 17.0, 'seed': 0, 'batch_size': 128, 'learning_rate': 0.01, 'training_bit_count': 32, 'implementation': 'cuda', 'num_iterations': 10000, 'eval_freq': 1000, 'valid_set_size': 0.0, 'extensive_eval': False, 'connections': 'unique', 'architecture': 'threshold_connected', 'num_neurons': 2000, 'num_layers': 1, 'num_active': 6, 'grad_factor': 2.0}
x_batch.shape: torch.Size([128, 2352])
y_batch.shape: torch.Size([128])
Unique values in y_batch: tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
total_num_neurons=3000
total_num_weights=21001
model is on: cuda:0
CustomModel(
  (model): Sequential(
    (0): Flatten(start_dim=1, end_dim=-1)
    (1): ThresholdLayer(in_dim=2352, out_dim=2000, num_active=6, bias=True, grad_factor=2.0, impl=indexed, layer_id=1)
    (2): CustomSigmoid(scale=1.0)
    (3): ThresholdLayer(in_dim=2000, out_dim=1000, num_active=6, bias=True, grad_factor=2.0, impl=indexed, layer_id=3)
    (4): CustomSigmoid2(scale=1.0)
    (5): GroupSum(k=10, tau=17.0)
  )
)
Trainable parameters by layer:

Layer: 'model.1'
  weight_k: shape (2000, 6), count 12000
  bias: shape (2000,), count 2000

Layer: 'model.2'
  s: shape (), count 1

Layer: 'model.3'
  weight_k: shape (1000, 6), count 6000
  bias: shape (1000,), count 1000
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 9.20887565612793 min: -9.116150856018066
Parameter s value: 8.263233184814453
Sigmoid Output max: 1.0 min: 1.9278932036241014e-33
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 5.285305976867676 min: -10.35584545135498
Parameter p value: 1.6999969482421875
Sigmoid2 Output max: 0.9998747110366821 min: 2.2609262018136178e-08
 
 -----Evaluating GroupSum-----
Input x max: 0.9999999403953552 min: -1.0
Output max: 5.4407219886779785 min: -5.614867687225342
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 1000/10000: Loss = 0.546327
{'train_acc_eval_mode': 0.9291866987179487, 'test_acc_eval_mode': 0.9292868589743589, 'test_acc_train_mode': 0.9292868589743589}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 92.93%
IS THE BEST UNTIL NOW.
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 8.421716690063477 min: -10.026906967163086
Parameter s value: 7.70935583114624
Sigmoid Output max: 1.0 min: 2.6828998630925657e-34
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 7.768415927886963 min: -14.207120895385742
Parameter p value: 2.455293655395508
Sigmoid2 Output max: 1.0 min: 7.09016975312211e-16
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.191732406616211 min: -5.729409694671631
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 2000/10000: Loss = 0.259606
{'train_acc_eval_mode': 0.9365985576923077, 'test_acc_eval_mode': 0.9364983974358975, 'test_acc_train_mode': 0.9402043269230769}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 93.65%
IS THE BEST UNTIL NOW.
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 9.620986938476562 min: -11.511473655700684
Parameter s value: 7.027276992797852
Sigmoid Output max: 1.0 min: 7.379794286463741e-36
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 8.411483764648438 min: -17.23154640197754
Parameter p value: 3.210590362548828
Sigmoid2 Output max: 1.0 min: 9.404521638575812e-25
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.672595024108887 min: -5.778565883636475
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 3000/10000: Loss = 0.239508
{'train_acc_eval_mode': 0.9373163728632479, 'test_acc_eval_mode': 0.9360977564102564, 'test_acc_train_mode': 0.9412059294871795}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 10.747151374816895 min: -11.960323333740234
Parameter s value: 6.569459915161133
Sigmoid Output max: 1.0 min: 7.520329572262464e-35
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 9.37712574005127 min: -19.048439025878906
Parameter p value: 3.9658870697021484
Sigmoid2 Output max: 1.0 min: 1.5548008475647078e-33
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.679421901702881 min: -5.732083320617676
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 4000/10000: Loss = 0.227198
{'train_acc_eval_mode': 0.9390357905982906, 'test_acc_eval_mode': 0.9386017628205128, 'test_acc_train_mode': 0.9435096153846154}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 93.86%
IS THE BEST UNTIL NOW.
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 10.728158950805664 min: -12.62297248840332
Parameter s value: 6.195114612579346
Sigmoid Output max: 1.0 min: 1.0910420841722882e-34
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 9.625249862670898 min: -20.378732681274414
Parameter p value: 4.721183776855469
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.181178092956543 min: -5.8739094734191895
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 5000/10000: Loss = 0.223426
{'train_acc_eval_mode': 0.9394364316239316, 'test_acc_eval_mode': 0.9381009615384616, 'test_acc_train_mode': 0.9429086538461539}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 11.821619033813477 min: -14.884982109069824
Parameter s value: 6.165412902832031
Sigmoid Output max: 1.0 min: 0.0
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 10.815221786499023 min: -21.58932113647461
Parameter p value: 5.476480484008789
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.138220310211182 min: -5.876436233520508
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 6000/10000: Loss = 0.220033
{'train_acc_eval_mode': 0.9393529647435898, 'test_acc_eval_mode': 0.9392027243589743, 'test_acc_train_mode': 0.9444110576923077}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-02
Best Accuracy: 93.92%
IS THE BEST UNTIL NOW.
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 12.075478553771973 min: -15.460655212402344
Parameter s value: 6.11092472076416
Sigmoid Output max: 1.0 min: 0.0
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 10.586498260498047 min: -22.98520278930664
Parameter p value: 6.231777191162109
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.397793769836426 min: -5.86305570602417
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 7000/10000: Loss = 0.220367
{'train_acc_eval_mode': 0.9375166933760684, 'test_acc_eval_mode': 0.9370993589743589, 'test_acc_train_mode': 0.9460136217948718}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 11.972039222717285 min: -13.513851165771484
Parameter s value: 6.2426276206970215
Sigmoid Output max: 1.0 min: 2.3018428103192836e-37
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 9.575783729553223 min: -20.65407371520996
Parameter p value: 6.98707389831543
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.457683086395264 min: -5.7743449211120605
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 8000/10000: Loss = 0.206333
{'train_acc_eval_mode': 0.9399205395299145, 'test_acc_eval_mode': 0.9390024038461539, 'test_acc_train_mode': 0.9472155448717948}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 11.37106704711914 min: -16.638879776000977
Parameter s value: 6.4139862060546875
Sigmoid Output max: 1.0 min: 0.0
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 9.48940372467041 min: -22.784711837768555
Parameter p value: 7.74237060546875
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.394819259643555 min: -5.764573574066162
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 9000/10000: Loss = 0.203604
{'train_acc_eval_mode': 0.9406216613247863, 'test_acc_eval_mode': 0.9391025641025641, 'test_acc_train_mode': 0.9472155448717948}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
[ThresholdLayer id=1] x:(128, 2352) x_g:(128, 2000, 6) y:(128, 2000)
--- Debug Info for CustomSigmoid ---
Sigmoid Input max: 11.34786605834961 min: -15.557087898254395
Parameter s value: 6.564116954803467
Sigmoid Output max: 1.0 min: 0.0
[ThresholdLayer id=3] x:(128, 2000) x_g:(128, 1000, 6) y:(128, 1000)
--- Debug Info for CustomSigmoid2 ---
Sigmoid2 Input max: 9.512439727783203 min: -23.4057674407959
Parameter p value: 8.49766731262207
Sigmoid2 Output max: 1.0 min: 0.0
 
 -----Evaluating GroupSum-----
Input x max: 1.0 min: -1.0
Output max: 5.739146709442139 min: -5.7644734382629395
----------------------------------------------------------------------------------------------------------------------------------------------------------------
   
Iteration 10000/10000: Loss = 0.201810
{'train_acc_eval_mode': 0.9404714209401709, 'test_acc_eval_mode': 0.9399038461538461, 'test_acc_train_mode': 0.9473157051282052}
-----------------------------------------------------------------------------------------------------------------------------------------------------------
Current Learning Rate: 1.00e-03
Best Accuracy: 93.99%
IS THE BEST UNTIL NOW.


Test Accuracy: 94.00%
